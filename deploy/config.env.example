# exitmap DNS Health Validation Configuration
# Copy this file to config.env and customize as needed.
#
# Usage:
#   cp config.env.example config.env
#   nano config.env
#   ./scripts/run_dns_validation.sh

# === Paths ===
# Directory where exitmap is installed (defaults to parent of scripts/)
# EXITMAP_DIR=/home/exitmap/exitmap

# Directory for output files (reports, analysis)
OUTPUT_DIR=${EXITMAP_DIR:-/home/exitmap/exitmap}/results

# Directory for log files
LOG_DIR=${EXITMAP_DIR:-/home/exitmap/exitmap}/logs

# === Scan Settings ===
# Seconds between circuit builds (0 = fastest, higher = gentler on network)
BUILD_DELAY=0

# Random variance added to build delay (0 = no variance)
DELAY_NOISE=0

# Your controlled relay fingerprint for first hop (recommended for reliability)
# Leave empty to use random first hops
# When set, this is tracked in each result's "first_hop" field for accountability
FIRST_HOP=

# Use reliable guards for random first-hop selection (true/false)
# When enabled, filters to relays with GUARD+STABLE+FAST+RUNNING+VALID flags
# and â‰¥5MB/s measured bandwidth. Ignored if FIRST_HOP is set.
RELIABLE_FIRST_HOP=false

# Include BadExit relays in scan (true/false)
ALL_EXITS=true

# === Tor Circuit Settings ===
# Max concurrent circuits for parallel scanning (optimal from experiments)
# MAX_PENDING_CIRCUITS=128

# === DNS Validation Settings ===
# Wildcard domain for DNS validation. Must be a wildcard DNS record where
# *.domain resolves to DNS_EXPECTED_IP. Leave default to use 1aeo.com's
# infrastructure, or set your own for independent validation.
# DNS_WILDCARD_DOMAIN=tor.exit.validator.1aeo.com
# DNS_EXPECTED_IP=64.65.4.1

# Timing settings (defaults are optimal based on experiments)
# DNS_QUERY_TIMEOUT=45    # seconds per DNS query
# DNS_MAX_RETRIES=3       # retry attempts per relay
# DNS_HARD_TIMEOUT=180    # max seconds for entire probe
# DNS_RETRY_DELAY=1.0     # seconds between retries

# === Cleanup ===
# Automatically clean up analysis directories older than 7 days
CLEANUP_OLD=true

# === Retry Settings (for run_with_retry.sh) ===
# Seconds to wait for Tor bootstrap before restarting
BOOTSTRAP_TIMEOUT=90

# Number of retry attempts on bootstrap failure
MAX_BOOTSTRAP_RETRIES=3

# Seconds between progress checks
PROGRESS_CHECK_INTERVAL=10

# Cron schedule (for manage_cron.sh)
CRON_SCHEDULE="0 */6 * * *"

# === DigitalOcean Spaces (optional) ===
DO_ENABLED=false
DO_BUCKET=exitmap-dns-results
DO_SPACES_KEY=
DO_SPACES_SECRET=
DO_SPACES_REGION=nyc3
DO_SPACES_ENDPOINT=https://nyc3.digitaloceanspaces.com

# === Cloudflare R2 (optional) ===
R2_ENABLED=false
R2_BUCKET=exitmap-dns-results
R2_ACCESS_KEY_ID=
R2_SECRET_ACCESS_KEY=
R2_ENDPOINT=https://<account_id>.r2.cloudflarestorage.com

# === Cloudflare Pages (optional) ===
# Used by upload scripts to purge cache after upload
CF_ACCOUNT_ID=
CF_API_TOKEN=
PAGES_PROJECT=exitmap-dns
